<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>LoboTutor by HoboApps</title>

    <!-- check for https -->
    <script type="text/javascript">
      if (location.protocol != 'https:') {
        location.href = 'https:' + window.location.href.substring(window.location.protocol.length);
      }
    </script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
      html {
        position: relative;
        height: 100%;
        margin: 0;
        padding: 0;
      }
      body {
        width: 100%;
        height: 100%;
        margin: 0px;
        padding: 0;
        position: absolute;
      }
      .navbar-inverse {
        background-image: none;
        background-color: #c10037;
      }
      .navbar-inverse .navbar-brand {
        color: #f5f5f5;
      }
      #map {
        height: 100%;
      }
      #homeSearchAsType {
        position: absolute;
        top: 60px;
        width: 95%;
        left: 2.5%;
        right: 2.5%;
      }
      #alertMessage {
          position: absolute;
          top: 100px;
          width: 95%;
          left: 2.5%;
          right: 2.5%;
      }

     /* #tutorLocationUpdate {
          background-color: #c10037;
      }*/
      .footer {
        position: absolute;
        bottom: 0;
        width: 100%;
        /* Set the fixed height of the footer here */
        height: 54px;
        background-color: #c10037;
      }
      body > .container {
        padding: 50px 0 0;
      }
      /*
      .footer ul {
        margin: 10px 0;
      }
      .footer a {
        color: #f5f5f5;
      }
      .footer ul li {
        font-size: x-large;
      }
      */
      .footer ul {
        /*Equally spaced footer buttons*/
          display: -moz-box;
          display: -webkit-box;
          display: box;

          width: 100%;
          border: 0;
          padding: 0;
          background-color: #c10037;
      }

      .footer a {
          display: block;
          padding: 0 0;
          color: #f5f5f5;
          background-color: #c10037;
          text-decoration: none;
          text-align: center;
      }
      .footer li {
          -moz-box-flex: 1;
          -webkit-box-flex: 1;
          box-flex: 1;
          font-size: x-large;
      }

      .nav>li>a:focus, .nav>li>a:hover {
          text-decoration: none;
          background-color: #c10037;
      }

      .navbar-toggle {
        border:none;
        font-size:larger;
        color:white;
      }

      .navbar-inverse .navbar-toggle:focus{
        background-color:transparent;
      }

     </style>
  </head>
  <body>
    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
 <!--          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button> -->

          <button type="button" class="navbar-toggle collapsed" data-toggle="modal" data-target="#Settings" aria-expanded="false" aria-controls="navbar" aria-hidden="true">
          <span class="glyphicon glyphicon-cog"</span>
          </button>

          <a class="navbar-brand" href="#"><span class="glyphicon glyphicon-education" aria-hidden="true"></span> LoboTutor</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <!-- Begin page content -->
    <div id="map"></div>
    <input id="homeSearchAsType" type="text" class="form-control" name="" placeholder="What are you looking to learn?" />

    <div id="alertMessage" class="alert alert-success fade in" role="alert" style="display:none">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <span id="alertMessageSpan"> <strong>Well done!</strong> You have successfully logged in.</span>
    </div>

    <!-- Main settings 
    Profile Picture, Name, email, Password, Department-->
    <div class="modal fade" id="Settings" tabindex="-1" role="dialog" aria-labelledby="userSettingsLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="userSettingsLabel">User Settings</h4>
          </div>
          <div class="modal-body">

            <div class="text-center">
              <img class="img-circle" src="http://www.sports-logos-screensavers.com/user/New_Mexico_Lobos.jpg" style="max-height: 140px;" />
            </div>

            <br />

            <form>
              <div class="form-group">
                <label for="deptInput">Name</label>
                <input type="name" class="form-control" id="nameInput" name="name" placeholder="Name">
              </div>

              <div class="form-group">
                <label for="exampleInputEmail1">Email address</label>
                <input type="email" class="form-control" name = "email" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email">
                <small id="emailHelp" class="form-text text-muted">Your email address will be kept confidential.</small>
              </div>

              <div class="form-group">
                <label for="exampleInputPassword1">Password</label>
                <input type="password" class="form-control" name="password" id="exampleInputPassword1" placeholder="Password">
              </div>

              <div class="form-group">
                <label for="deptInput">Department</label>
                <input type="dept" class="form-control" id="deptInput" name="dept" placeholder="Department">
              </div>
 <!--              <div class="form-group">
                <label for="exampleSelect1">Example select</label>
                <select class="form-control" id="exampleSelect1">
                  <option>1</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5</option>
                </select>
              </div> -->
            </form>
          </div>
          <div class="modal-footer">
            <button id="saveMainSettings" type="button" class="btn btn-danger" data-loading-text="saving...">Save changes</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button id="logOutButtonMain" type="button" class="btn btn-default" data-dismiss="modal">Logout</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Schedule -->
    <div class="modal fade" id="studentSettings" tabindex="-1" role="dialog" aria-labelledby="studentSettingsLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="studentSettingsLabel">Class Schedule </h4>
          </div>
          <div class="modal-body">
            <form id="studentSettingsForm">
              <table class="table table-striped">
                <thead>
                  <tr>
                    <th>Subject</th>
                    <th>Course</th>
                    <th>Title</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Mark</td>
                    <td>Otto</td>
                    <td>@mdo</td>
                  </tr>
                </tbody>
              </table>
            </form>
          </div>
          <div class="modal-footer">
            <form class="form-inline">
              <div class="form-group">
                <label for="exampleInputEmail2">Class</label>
                <input type="email" class="form-control" id="exampleInputEmail2" placeholder="ECE 500">
              </div>
              <button type="submit" class="btn btn-default">
                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Tutor Settings -->
    <!-- payment, name, profile pic, email, topics, status (active, inactive), 5 star rating, trophies/badges,etc.-->
    <div class="modal fade" id="tutorSettings" tabindex="-1" role="dialog" aria-labelledby="tutorSettingsLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="tutorSettingsLabel">Tutor Profile</h4>
          </div>
          <div class="modal-body">

            <div class="text-center">
              <img class="img-circle" src="http://www.sports-logos-screensavers.com/user/New_Mexico_Lobos.jpg" style="max-height: 140px;" />
            </div>

            <br />
            <div class="btn-group btn-group-justified" role="group" aria-label="...">
              <div class="btn-group" role="group">
                <button id="tutorLocationUpdate" type="button" class="btn btn-danger" data-loading-text="updating...">Update location</button> <!--btn-warning-->
              </div>
            </div>

            <br />
            <form>
              <div class="form-group">
                <input type="text" class="form-control" name="name" placeholder="Name" />
              </div>
              <div class="form-group">
                <input type="text" class="form-control" name="subjects" placeholder="What are you interested in teaching?" />
              </div>
              <div class="form-group">
                <input type="text" class="form-control" name="rate" placeholder="Hourly rate" />
              </div>
              <div class="form-group">
                <input type="text" class="form-control" name="location" placeholder="Specific Location (i.e. ECE Room 204)" />
              </div>
              <div class="form-group">
                <input type="file" accept="image/*" capture="camera">
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button id="saveTutorSettings" type="button" class="btn btn-danger" data-loading-text="saving...">Save changes</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- tutor profile -->
    <div class="modal fade" id="tutorProfile" tabindex="-1" role="dialog" aria-labelledby="tutorProfileLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="tutorProfileLabel">Tutor name</h4>
          </div>
          <div class="modal-body">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>    

    <!-- About -->
    <div class="modal fade" id="aboutPage" tabindex="-1" role="dialog" aria-labelledby="aboutPageLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="aboutPageLabel">About</h4>
          </div>
          <div class="modal-body">
            <p>Hobo Apps is based in Albuquerque, NM. Our mission is to create something worthy of winning the app contest.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- log in -->
    <div class="modal fade" id="logInPage" tabindex="-1" role="dialog" aria-labelledby="logInPageLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="logInPageLabel">Login</h4>
          </div>
          <div class="modal-body">
            <form id="loginForm">
              <div class="form-group">
                <input type="text" class="form-control" name="netid" placeholder="UNM NetID" />
              </div>
              <div class="form-group">
                <input type="password" class="form-control" name="password" placeholder="LoboTutor password" />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button id="loginButton" type="button" class="btn btn-danger">Login</button>
            <button type="button" class="btn btn-default" data-toggle="modal" data-target="#registerPage" data-dismiss="modal">Create account</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- register -->
    <div class="modal fade" id="registerPage" tabindex="-1" role="dialog" aria-labelledby="registerPageLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="registerPageLabel">Register</h4>
          </div>
          <div class="modal-body">
            <form id="createAccountForm">
              <div class="form-group">
                <input type="text" class="form-control" name="name" placeholder="Name" />
              </div>
              <div class="form-group">
                <input type="text" class="form-control" name="netid" placeholder="School email" />
              </div>
              <div class="form-group">
                <input type="password" class="form-control" name="password" placeholder="LoboTutor password" />
              </div>
              <div class="form-group">
                <input type="password" class="form-control" name="password_confirm" placeholder="Confirm LoboTutor password" />
              </div>
              <hr />
              <div class="form-group">
                <input type="text" class="form-control" name="dept" placeholder="Department" />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button id="createAccountButton" data-loading-text="Creating..." type="button" class="btn btn-danger">Create account</button>
            <button type="button" class="btn btn-default" data-toggle="modal" data-target="#logInPage" data-dismiss="modal">Login</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <footer class="footer">
      <div class="container">
        <ul class="nav nav-pills">
          <li><a href="#student-profile" data-toggle="modal" data-target="#logInPage"><span class="glyphicon glyphicon-align-justify" aria-hidden="true" title="Class Schedule"></span></a></li>
          <li><a href="#tutor-profile"><span class="glyphicon glyphicon-education" aria-hidden="true" title="Become a tutor"></span></a></li>
          <li><a href="#" data-toggle="modal" data-target="#aboutPage"><span class="glyphicon glyphicon-info-sign" aria-hidden="true" title="About"></span></a></li>
        </ul>
      </div>
    </footer>



    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    
    <!-- firebase -->
    <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase-database.js"></script>
    <!-- Leave out Storage -->
    <!-- <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase-storage.js"></script> -->
    
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCQLOEhiGJrB1fkFQPT9KjgQ3MOcGNpLic"></script>
    <script>
      $(document).ready( function () {
        // Initialize Firebase
        var config = {
          apiKey: "AIzaSyB7NvzRR35IhafEfpimyJ94e7vpK1rKD2c",
          authDomain: "lobotutor-5ebc3.firebaseapp.com",
          databaseURL: "https://lobotutor-5ebc3.firebaseio.com",
          storageBucket: "lobotutor-5ebc3.appspot.com",
          messagingSenderId: "1049411663613"
        };
        firebase.initializeApp(config)

        // initialize map
        var map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 0, lng: 0},
          zoom: 16,
          mapTypeControl: false,
          zoomControl: true,
          zoomControlOptions: {
              position: google.maps.ControlPosition.RIGHT_CENTER
          },
          streetViewControl: false,
        })

        // Create the DIV to hold the control and call the CustomControl() constructor passing in this DIV.
        var customControlDiv = document.createElement('div');
        var customControl = new CustomControl(customControlDiv, map);

        customControlDiv.index = 1;
        map.controls[google.maps.ControlPosition.RIGHT_CENTER].push(customControlDiv);

        function CustomControl(controlDiv, map) {
         
            // Set CSS for the control border.
            var controlUI = document.createElement('div');
            controlUI.style.backgroundColor = '#fff';
            controlUI.style.border = '2px solid #fff';
            controlUI.style.borderRadius = '3px';
            controlUI.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
            controlUI.style.cursor = 'pointer';
            controlUI.style.marginBottom = '22px';
            controlUI.style.marginRight = '10px';
            controlUI.style.textAlign = 'center';
            controlUI.title = 'Click to recenter the map';
            controlDiv.appendChild(controlUI);

            // Set CSS for the control interior.
            var controlText = document.createElement('div');
            controlText.style.color = '#686868';
            controlText.style.fontSize = '16px';
            controlText.style.lineHeight = '24px';
            controlText.style.paddingLeft = '4px';
            controlText.style.paddingBottom = '0px';
            controlText.style.paddingTop = '2px';
            controlText.style.paddingRight = '4px';
            controlText.innerHTML = '<span class="glyphicon glyphicon-screenshot" aria-hidden="true"></span>';
            controlUI.appendChild(controlText);

            // Setup the click event listeners to center the map
            google.maps.event.addDomListener(controlUI, 'click', function () {
                        user.location.update();
            });
        }

        // initialize user object
        user = {
          location:  {
            latlng: null,
            update: function () {
              // get user's location
              navigator.geolocation.getCurrentPosition(function(position) {
                // get latlng
                user.location.latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude)
                // center the map
                map.setCenter(user.location.latlng)
                // put a marker at user's location
                // var marker = new google.maps.Marker({
                //   position: user.location.latlng,
                //   map:map
                // })
              }, function (error) {
                // center the map at UNM
                map.setCenter( new google.maps.LatLng(35.0843188, -106.6197811) )
              })
            }
          }
        }
        // update location, does not need login
        user.location.update()

        // load all profiles from firebase because eff firebase
        // then show on map
        profiles = {}
        var reloadProfiles = function () {
          firebase.database().ref('/profile/').once('value').then( function (snapshot) {
            profiles = snapshot.val()
            // show on map
            Object.keys(profiles).forEach( function(k,v) {
              var marker = new google.maps.Marker({
                position: new google.maps.LatLng(profiles[k].lat, profiles[k].lng),
                map:map,
                uid: k
              })
              // load tutor profile on marker click
              google.maps.event.addListener(marker, 'click', function() {
                firebase.database().ref('/profile/' + marker.uid ).once('value').then( function (snapshot) {
                  tutor = snapshot.val()
                  $('#tutorProfileLabel').html( tutor.name )
                  $('#tutorProfile').modal('show')
                } )
              })
            } )
          } )
        }
        reloadProfiles()

        /* initialize done, user profile related functions 1s after page load because eff firebase */
        // if logged in, get information from database
        setTimeout( function() {
          // update map with user's subjects
        }, 1000 )
        
        /* events */
        
        // profile button functionality
        $('a[href="#student-profile"]').click( function() {
          // check login
          if ( ! firebase.auth().currentUser ) {
            $('#logInPage').modal('show')
            return false 
          }
          $('#studentSettings').modal('show')
          return false
          // pre-populate form

        } )
        
        // login functionality
        $('#loginButton').on('click', function () {
          var $btn = $(this).button('loading')
          email = $('#loginForm').find('input[name=netid]').val().trim()
          password = $('#loginForm').find('input[name=password]').val().trim()
          firebase.auth().signInWithEmailAndPassword( email, password )
            .then( function (u) {
              $btn.button('reset')
              $('#logInPage').modal('hide')
              $("#alertMessage #alertMessageSpan").html("<strong> Hello, " + profiles[firebase.auth().currentUser.uid].name + "! </strong> You have successfully logged in.")
              $("#alertMessage").show()
              setTimeout( function() {
                $("#alertMessage").hide()
              }, 2000 )
            }, function(error) {
              // Handle Errors here.
              var errorCode = error.code;
              var errorMessage = error.message;
              if (errorCode === 'auth/wrong-password') {
                alert('Invalid password.  Please try again.');
              } 
              else if (errorCode === 'auth/user-not-found') {
                alert('User email not found.');
              } 
              else if (errorCode === 'auth/invalid-email') {
                alert('Invalide email address.  Please use a valid university email address.');
              } 
              else {
                alert("Please use a valid university email address and/or password.") <!--error.message-->
              }
              $btn.button('reset')
            } );
        })

        // logout functionality
        $('logOutButtonMain').on('click', function () {
          var $btn = $(this).button('loading')
          name = profiles[firebase.auth().currentUser.uid].name
          firebase.auth().signOut().then(function() {
            $("#alertMessage #alertMessageSpan").html("<strong>Goodbye " + name + "!</strong> You are now logged out.")
            $("#alertMessage").show()
            $btn.button('reset')
            $('#studentSettings').modal('hide')
            setTimeout( function() {
               $("#alertMessage").hide()
            }, 2000 ) 
          }, function(error) {
            alert(error.message)
            $btn.button('reset')
          });
        })

        // register functionality
        $('#createAccountButton').on('click', function () {
          var $btn = $(this).button('loading')
          // get register data from the form
          email = $('#createAccountForm').find('input[name=netid]').val().trim()
          password = $('#createAccountForm').find('input[name=password]').val().trim()
          name = $('#createAccountForm').find('input[name=name]').val().trim() ? $('#createAccountForm').find('input[name=name]').val().trim() : email.substring(0, email.indexOf("@"))
          dept = $('#createAccountForm').find('input[name=dept]').val().trim()
          // register
          firebase.auth().createUserWithEmailAndPassword( email, password )
            .then( function () {
              // hide register page
              $btn.button('reset')
              $('#registerPage').modal('hide')

              // update profile information
              postData = {
                name: name,
                dept: dept
              }
              firebase.database().ref('profile/' + firebase.auth().currentUser.uid).update(postData).then( function () {
                reloadProfiles()
              }, function (error) {
                alert(error.message)
              } );
            }, function (error) {
              alert(error.message)
              $btn.button('reset')
            } );
        })

        // save student settings
        $('#saveStudentSettings').on('click', function () {
          var $btn = $(this).button('loading')

        })

        // subject search box code
        // autocomplete
        // get tutors, show on map

        // tap a tutor code
        // check if logged in
        // show tutor information

        // contact tutor - todo

        // become a tutor button
        $('a[href="#tutor-profile"]').click( function() {
          // check login
          if ( ! firebase.auth().currentUser ) {
            $('#logInPage').modal('show')
            return false 
          }
          firebase.database().ref('/profile/' + firebase.auth().currentUser.uid).once('value').then(function(snapshot) {
            $('#tutorSettings').find('input[name=name]').val(snapshot.val().name)
            $('#tutorSettings').find('input[name=subjects]').val(snapshot.val().tutor_settings)
          });
          $('#tutorSettings').modal('show')
          return false
          // pre-populate form
        } )

        // tutor setting save changes functionality
        $('#saveTutorSettings').on('click', function () {
          console.log('here')
          var $btn = $(this).button('loading')
          postData = {
            name: $('#tutorSettings').find('input[name=name]').val(),
            tutor_settings: $('#tutorSettings').find('input[name=subjects]').val()
          }
          console.log(postData)
          firebase.database().ref('profile/' + firebase.auth().currentUser.uid).update(postData).then( function () {
            $btn.button('reset')
            reloadProfiles()
          }, function (error) {
            alert(error.message)
          } );
        })

        // tutor location update
        $('#tutorLocationUpdate').on('click', function () {
          var $btn = $(this).button('loading')
          navigator.geolocation.getCurrentPosition(function(position) {
            firebase.database().ref('profile/' + firebase.auth().currentUser.uid).update({
              lat: position.coords.latitude,
              lng: position.coords.longitude
            }).then( function () {
              $btn.button('reset')
              reloadProfiles()
            }, function (error) {
              alert(error.message)
            } );
          })
        })

      } )

    </script>
  </body>
</html>
